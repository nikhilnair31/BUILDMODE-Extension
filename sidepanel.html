<!-- sidepanel.html -->

<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <title>Related Images</title>
        <style>
            @font-face {
                font-family: "VenusCormier";
                src: url("assets/fonts/venus_cormier.otf") format("opentype");
                font-weight: normal;
                font-style: normal;
            }
            :root { 
                color-scheme: dark; 
                --base-0: #1e1c2c;
                --base-1: #221f31;
                --base-2: #7b7889;
                --accent-0: #deff96;
                --accent-0x: #ECFFCF;
                --accent-1: #A67BF2;
                --accent-1t: #337553B0;
            }
            body { 
                display: flex; 
                flex-direction: column; 
                min-height: 100dvh; 
                margin: 0; 
                font-family: "VenusCormier", system-ui, sans-serif;
                background: var(--base-0);
                color: white;
            }
            header { 
                flex: 0 0 auto; 
                flex-direction: column;
                padding: 12px;
                z-index: 1; 
                align-items: stretch;
                background-color: var(--base-1);
            }
            .card { 
                border: 1px solid rgba(255,255,255,.1); 
                border-radius: 0;      /* <-- HARSH corners */
                overflow: hidden; 
            }
            .thumb { 
                width: 100%; 
                object-fit: cover; 
                display: block; 
                cursor: zoom-in;
            }
            .empty { 
                padding: 16px;
                color: var(--base-2);
                text-align: center;
                width: 100%;              /* Ensure it takes full width of its parent */
            }
            button { 
                padding: 12px; 
                font-family: "VenusCormier", system-ui, sans-serif;
                cursor: pointer; 
                background: var(--accent-1t);
                border: none;
                border-radius: 0;   /* <-- HARSH corners */
                color: var(--accent-0x);
            }

            /* placeholder styling */
            .thumb[data-placeholder="1"] {
                filter: grayscale(0.1) contrast(0.95);
            }

            #app_title {
                font-size: x-large;
                color: var(--accent-0);
            }

            /* Masonry layout */
            #grid {
                flex: 1 1 auto;
                column-width: 260px;
                column-gap: 12px;
                padding: 12px;
            }
            #grid:has(.empty) {
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .card {
                display: inline-block;
                width: 100%;
                margin: 0 0 12px;
                border: 1px solid rgba(255,255,255,.12);
                border-radius: 0;   /* <-- HARSH corners */
                overflow: hidden;
                break-inside: avoid;
            }

            /* responsive */
            @media (max-width: 900px)  { #grid { column-width: 220px; } }
            @media (max-width: 600px)  { #grid { column-width: 180px; } }

            /* Lightbox */
            #deleteBtn {
                right: 80px; 
                background: #a22; 
                color: #fff;
            }
            
            #linksBox {
                padding: 10px 14px;
                background: var(--base-1);
                display: flex;
                gap: 16px;
                flex-direction: row;
                flex-wrap: nowrap;
                justify-content: flex-start;
                align-items: center;
            }
            #refreshBtn {
                width: 100%;
                padding: 12px;
                font-family: "VenusCormier", system-ui, sans-serif;
                cursor: pointer;
                background: var(--accent-0);
                border: none;
                border-radius: 0;
                color: var(--accent-1);
            }
            #savesLeftTxt {
                padding: 12px;
                font-family: "VenusCormier", system-ui, sans-serif;
                cursor: pointer;
                text-align: center;
                border: none;
                border-radius: 0;
                color: var(--accent-0);
                background: var(--accent-1);
            }

            #linksBox a {
                display: block;
                color: var(--accent-0);
                font-weight: 500;
                margin: 4px 0;
                text-decoration: none;
                word-break: break-all;
            }

            #linksBox a:hover {
                color: var(--accent-1);
                text-decoration: underline;
            }

            #overlay {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.95);
            display: none;
            flex-direction: column;
            z-index: 9999;
            }
            #overlay.open { display: flex; }

            .lightbox-toolbar {
                position: sticky;
                top: 0;
                display: flex;
                align-items: center;
                background: var(--base-1);
                padding: 10px;
                gap: 10px;
                z-index: 2;
            }
            .lightbox-toolbar .spacer { flex: 1; }
            .lightbox-toolbar button {
            border: none;
            padding: 8px 14px;
            font-size: 14px;
            cursor: pointer;
            font-family: "VenusCormier", system-ui, sans-serif;
            }
            #backBtn   { background: var(--base-2); color: white; }
            #closeBtn  { background: var(--accent-1); color: white; }
            #deleteBtn { background: #b91c1c; color: white; }

            .lightbox-content {
                flex: 1;
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                overflow: auto;
                padding: 20px;
                background: var(--base-0);
            }
            #fullImg {
            max-width: 100%;
            max-height: 80vh;
            object-fit: contain;
            cursor: zoom-in;
            transition: transform 0.2s ease;
            }
            #fullImg.zoomed {
            transform: scale(2);
            cursor: zoom-out;
            }
            #linksBox {
            margin-top: 20px;
            text-align: center;
            }
            .header-top {
                display: flex;
                justify-content: space-between;
                align-items: center;
                padding: 12px;
            }
            .tier-info {
                display: flex;
                flex-direction: column;
                font-size: 13px;
                color: var(--base-2);
            }
            .tier-info span {
                display: block;
                line-height: 1.2;
            }
            .tier-info b {
                color: var(--accent-0);
                font-weight: normal;
            }

        </style>
    </head>
    <body>
        <header>
            <div class="header-top">
                <span id="app_title">FORGOR</span>
                <div class="tier-info">
                    <span>Tier: <b id="userTier">Loading...</b></span>
                    <span>Saves: <b id="saveCounter">0</b> / <b id="maxSaves">0</b></span>
                </div>
            </div>
            <button id="refreshBtn" type="button" title="Refresh">REFRESH</button>
        </header>
        <main id="grid"></main>
        <div id="overlay" aria-hidden="true">
            <div class="lightbox-toolbar">
                <button id="backBtn">BACK</button>
                <div class="spacer"></div>
                <button id="deleteBtn">DELETE</button>
            </div>

            <div class="lightbox-content">
                <img id="fullImg" alt="" />
                <div id="linksBox"></div>
            </div>
        </div>

        <script type="module" src="sidepanel.js"></script>
    </body>
</html>
